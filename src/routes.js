const express = require('express');
const routes = express.Router();

//TODO: proteger el user y el password
routes.post('/login', (req, res) => {
    req.getConnection((err, connec) => {
        if (err) return res.send(err);
        const { user, pass } = req.body;
        const SQL = `SELECT id_usuario, rol FROM  credenciales WHERE usuario = ? and contrasenia = ?`;

        connec.query(SQL, [user, pass], (err, rows) => {

            if (err) console.log(err);
            if (rows.length > 0) {
                const data = {
                    'ok': true,
                    'result': rows
                }
                res.json(data);
            } else {
                const data = {
                    'ok': false,
                    'result': 'NO-DATA'
                }

                res.json(data);
            }

        })
    });
});

/*
.......##.......##..#######..##.....##.########.########..##....##..######...........########...#######...######..########.##....##.########.########...
......##.......##..##.....##.##.....##.##.......##.....##..##..##..##....##..........##.....##.##.....##.##....##.##.......###...##....##....##.........
.....##.......##...##.....##.##.....##.##.......##.....##...####...##................##.....##.##.....##.##.......##.......####..##....##....##.........
....##.......##....##.....##.##.....##.######...########.....##.....######...........##.....##.##.....##.##.......######...##.##.##....##....######.....
...##.......##.....##..##.##.##.....##.##.......##...##......##..........##..........##.....##.##.....##.##.......##.......##..####....##....##.........
..##.......##......##....##..##.....##.##.......##....##.....##....##....##..........##.....##.##.....##.##....##.##.......##...###....##....##.........
.##.......##........#####.##..#######..########.##.....##....##.....######...........########...#######...######..########.##....##....##....########...
*/





module.exports = routes;